<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Huichply</title>
    <!-- Agregando jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <!-- Agregando Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Agregando Font Awesome para iconos -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Climate+Crisis&family=Gabarito:wght@400..900&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Gabarito', Arial, sans-serif;
            color: #2a181c;
            background-color: #ede8dd;
            line-height: 1.4;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            padding-top: 60px; /* Para compensar el header fijo */
        }
        
        header {
            text-align: center;
            padding: 15px 0;
            width: 100%;
            position: fixed;
            top: 0;
            left: 0;
            z-index: 1000;
            background-color: #ede8dd;
       
        }
        
        .logo {
            height: 30px;
            width: auto;
            display: block;
            margin: 0 auto;
            max-width: 90%;
        }
        
        .hero {
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 0 20px;
            position: relative;
            overflow: hidden;
        }

        .floating-images {
            position: absolute;
            width: 100%;
            height: 100%;
            pointer-events: auto;
            z-index: 1;
            overflow: hidden;
        }

        .floating-img {
            position: absolute;
            height: auto;
            opacity: 0.9;
            filter: brightness(1.2);
            transition: transform 0.3s ease;
            cursor: pointer;
            pointer-events: auto;
        }

        /* Actualizar las animaciones para que sean compatibles con la interacción */
        .img1 { width: 150px; top: 10%; left: 10% ; animation: float1 8s ease-in-out infinite; }
        .img2 { width: 170px; top: 10%; right: 10%; animation: float2 9s ease-in-out infinite; }
        .img3 { width: 120px; bottom: 10%; left: 10%; animation: float3 7s ease-in-out infinite; }
        .img4 { width: 180px; bottom: 15%; right: 10%; animation: float4 10s ease-in-out infinite; }
        .img5 { width: 150px; top: 52%; left: 20%; animation: float5 8.5s ease-in-out infinite; }
        .img6 { width: 150px; top: 50%; left: 80%; animation: float5 8.5s ease-in-out infinite; }

        /* Flotación base */
        @keyframes float1 {
            0%, 100% { transform: translate(0, 0) rotate(0deg); }
            50% { transform: translate(-10px, -10px) rotate(-5deg); }
        }
        @keyframes float2 {
            0%, 100% { transform: translate(0, 0) rotate(0deg); }
            50% { transform: translate(10px, -15px) rotate(5deg); }
        }
        @keyframes float3 {
            0%, 100% { transform: translate(0, 0) rotate(0deg); }
            50% { transform: translate(-15px, 10px) rotate(-8deg); }
        }
        @keyframes float4 {
            0%, 100% { transform: translate(0, 0) rotate(0deg); }
            50% { transform: translate(10px, -12px) rotate(10deg); }
        }
        @keyframes float5 {
            0%, 100% { transform: translate(-50%, -50%) rotate(0deg); }
            50% { transform: translate(-50%, -55%) rotate(-5deg); }
        }
        
        /* Asegurar que el contenido principal esté por encima */
        .hero-content {
            position: relative;
            z-index: 2;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .hero h2 {
            font-family: 'Climate Crisis', sans-serif;
            font-weight: 400;
            font-size: 3.5rem;
            line-height: 1.1;
            margin-bottom: 40px;
            text-transform: uppercase;
            color: #2a181c;
        }
        
        .botones {
            display: flex;
            justify-content: center;
            gap: 25px;
            margin-top: 20px;
            flex-wrap: wrap;
            width: 100%;
        }
        
        .botones button {
            font-family: 'Gabarito', sans-serif;
            padding: 16px 40px;
            font-size: 1.1rem;
            font-weight: bold;
            background-color: #ff6700;
            color: #ede8dd;
            border: 0px solid #2a181c;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            letter-spacing: 1px;
            min-width: 200px;
        }
        
        .botones button:hover {
            background-color: #ec92ff;
            color: #2a181c;
            transform: translateY(-3px);
        }
        
        /* Estilos para los wizards */
        .wizard-container {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #ede8dd;
            z-index: 1000;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }
        
        .wizard-content {
            max-width: 600px;
            margin: 0 auto;
            padding: 40px 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            position: relative;
        }
        
        .wizard-close-x {
            position: fixed;
            top: 15px;
            right: 15px;
            font-size: 2.5rem;
            cursor: pointer;
            font-weight: bold;
            z-index: 1010;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #ede8dd;
            border-radius: 50%;
            color: #2a181c;
            border: 2px solid #2a181c;
        }
        
        .wizard-step {
            display: none;
        }
        
        .wizard-step.active {
            display: block;
        }
        
        .wizard-title {
            font-family: 'Gabarito', sans-serif;
            font-weight: 900;
            font-size: 2rem;
            margin-bottom: 30px;
            text-align: center;
            color: #2a181c;
        }
        
        .wizard-field {
            margin-bottom: 20px;
        }
        
        .wizard-field label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #2a181c;
        }
        
        .wizard-field input, 
        .wizard-field select, 
        .wizard-field textarea {
            width: 100%;
            padding: 15px;
            border: 2px solid #2a181c;
            border-radius: 4px;
            font-family: 'Gabarito', sans-serif;
            font-size: 1rem;
            -webkit-appearance: none;
            background-color: #fff;
        }
        
        .wizard-field input:focus, 
        .wizard-field select:focus, 
        .wizard-field textarea:focus {
            outline: none;
            border-color: #ff6700;
        }
        
        .wizard-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
            gap: 15px;
        }
        
        .wizard-buttons button {
            padding: 15px 25px;
            font-family: 'Gabarito', sans-serif;
            font-weight: bold;
            background-color: #ede8dd;
            color: #2a181c;
            border: 2px solid #2a181c;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            flex: 1;
            min-width: 120px;
        }
        
        .wizard-buttons button:hover {
            background-color: #2a181c;
            color: #ede8dd;
        }
        
        .wizard-buttons button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .wizard-buttons button:disabled:hover {
            background-color: #ede8dd;
            color: #2a181c;
        }
        
        .product-option {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .product-option input[type="checkbox"] {
            width: auto;
            margin-right: 10px;
        }
        
        .product-quantity {
            margin-left: 10px;
            width: 60px;
            padding: 5px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        
        /* Estilos mejorados para el slider de peso */
        .weight-slider {
            width: 100%;
            margin: 20px 0;
            -webkit-appearance: none;
            height: 10px;
            border-radius: 5px;
            background: #d3d3d3;
            outline: none;
        }
        
        .weight-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #ff6700;
            cursor: pointer;
        }
        
        /* Estilo para la barra de progreso con color */
        .weight-slider::-webkit-slider-runnable-track {
            height: 10px;
            border-radius: 5px;
            background: linear-gradient(to right, #ff6700, #ff3300);
        }
        
        .weight-slider::-moz-range-track {
            height: 10px;
            border-radius: 5px;
            background: linear-gradient(to right, #ff6700, #ff3300);
        }
        
        .weight-value {
            text-align: center;
            font-weight: bold;
            margin-top: 10px;
            color: #2a181c;
        }
        
        .confirmation-options {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin: 20px 0;
        }
        
        .confirmation-option {
            display: flex;
            align-items: center;
        }
        
        .confirmation-option input {
            width: auto;
            margin-right: 10px;
        }
        
        .error-message {
            color: #ff0000;
            font-size: 0.9rem;
            margin-top: 5px;
            display: none;
        }
        
        .success-message {
            text-align: center;
            margin: 30px 0;
        }
        
        .success-icon {
            font-size: 3rem;
            margin-bottom: 20px;
            color: #ff6700;
        }
        
        /* Nuevos estilos para botones seleccionables */
        .selectable-buttons {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .selectable-button {
            display: flex;
            align-items: center;
            padding: 12px 15px;
            border: 2px solid #2a181c;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            background-color: #ede8dd;
        }
        
        .selectable-button.selected {
            background-color: #2a181c;
            color: #ede8dd;
        }
        
        .selectable-button input[type="checkbox"] {
            display: none;
        }
        
        .selectable-button-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
        }
        
        .quantity-input {
            width: 60px;
            padding: 5px;
            border: 1px solid #ccc;
            border-radius: 4px;
            margin-left: 10px;
        }
        
        /* NUEVOS ESTILOS PARA BOTONES COMPACTOS RESPONSIVOS */
        .product-buttons-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .product-button {
            display: flex;
            align-items: center;
            padding: 12px 10px;
            border: 2px solid #2a181c;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            min-height: 70px;
            background-color: #ede8dd;
        }
        
        .product-button.selected {
            background-color: #2a181c;
            color: #ede8dd;
        }
        
        .product-button input[type="checkbox"] {
            display: none;
        }
        
        .product-button-content {
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            gap: 8px;
        }
        
        .product-button span {
            text-align: center;
            font-size: 0.9rem;
        }
        
        /* NUEVO: Estilos para los controles de cantidad mejorados */
        .quantity-controls {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
        }
        
        .quantity-btn {
            width: 28px;
            height: 28px;
            border: 1px solid #ccc;
            background-color: #fff;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
            padding: 0;
            transition: all 0.2s ease;
        }
        
        .quantity-btn:hover {
            background-color: #f0f0f0;
        }
        
        .quantity-btn:active {
            transform: scale(0.95);
        }
        
        .product-button-quantity {
            width: 40px;
            text-align: center;
            padding: 5px;
            border: 1px solid #ccc;
            border-radius: 4px;
            -moz-appearance: textfield;
            margin: 0;
        }
        
        .product-button-quantity::-webkit-outer-spin-button,
        .product-button-quantity::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        
        .product-button-quantity:focus {
            outline: none;
            border-color: #666;
        }
        
        .special-input-container {
            margin-top: 15px;
            padding: 15px;
            border: 2px solid #eee;
            border-radius: 8px;
            background-color: #f9f9f9;
            display: none;
        }
        
        .special-note {
            font-size: 0.85rem;
            color: #666;
            margin-top: 8px;
            font-style: italic;
        }
        
        .empresa-options {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin: 30px 0;
        }
        
        .empresa-option {
            padding: 20px 15px;
            border: 2px solid #2a181c;
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
            background-color: #ede8dd;
        }
        
        .empresa-option:hover {
            background-color: #2a181c;
            color: #ede8dd;
        }
        
        .input-error {
            border-color: #ff0000 !important;
        }
        
        /* Estilos para botones de selección única (radio buttons como botones) */
        .radio-buttons-container {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .radio-button-option {
            padding: 15px;
            border: 2px solid #2a181c;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            background-color: #ede8dd;
        }
        
        .radio-button-option.selected {
            background-color: #2a181c;
            color: #ede8dd;
        }
        
        .radio-button-option input[type="radio"] {
            display: none;
        }
        
        /* Estilos para la ventana modal de confirmación */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .modal-content {
            background-color: #ede8dd;
            padding: 25px;
            border-radius: 8px;
            max-width: 400px;
            width: 100%;
            text-align: center;
            border: 2px solid #2a181c;
        }
        
        .modal-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
        }
        
        .modal-buttons button {
            padding: 12px 20px;
            font-family: 'Gabarito', sans-serif;
            font-weight: bold;
            border: 2px solid #2a181c;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            flex: 1;
        }
        
        .modal-confirm {
            background-color: #2a181c;
            color: #ede8dd;
        }
        
        .modal-cancel {
            background-color: #ede8dd;
            color: #2a181c;
        }
        
        .modal-buttons button:hover {
            opacity: 0.8;
        }
        
        /* Estilos para opciones de volumen de envíos */
        .volume-options {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .volume-option {
            padding: 15px;
            border: 2px solid #2a181c;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            background-color: #ede8dd;
        }
        
        .volume-option.selected {
            background-color: #2a181c;
            color: #ede8dd;
        }
        
        .volume-option input[type="radio"] {
            display: none;
        }
        
        /* Nuevos estilos para campos de dirección */
        .address-fields {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        .address-full {
            grid-column: span 2;
        }
        
        /* Estilo para botón "No aplica" */
        .unknown-button {
            margin-top: 10px;
            padding: 12px 15px;
            background-color: #f0f0f0;
            border: 1px solid #ccc;
            border-radius: 4px;
            cursor: pointer;
            text-align: center;
            display: inline-block;
            width: 100%;
        }
        
        .unknown-button:hover {
            background-color: #e0e0e0;
        }
        
        /* Estilos para resumen de confirmación */
        .summary-container {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            background-color: #f9f9f9;
        }
        
        .summary-section {
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }
        
        .summary-section:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
        
        .summary-title {
            font-weight: bold;
            margin-bottom: 5px;
            color: #2a181c;
        }
        
        .summary-content {
            margin-left: 10px;
        }
        
        .summary-item {
            margin-bottom: 5px;
            word-break: break-word;
        }
        
        /* NUEVO: Estilos mejorados para medios de contacto */
        .contacto-option {
            margin-bottom: 15px;
        }
        
        .contacto-button {
            display: flex;
            align-items: center;
            padding: 12px 15px;
            border: 2px solid #2a181c;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            background-color: #ede8dd;
        }
        
        .contacto-button.selected {
            background-color: #2a181c;
            color: #ede8dd;
        }
        
        .contacto-button input[type="checkbox"] {
            display: none;
        }
        
        .contacto-button-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
        }
        
        .contacto-detalle-container {
            margin-top: 10px;
            padding: 15px;
            border: 2px solid #eee;
            border-radius: 8px;
            background-color: #f9f9f9;
            display: none;
        }
        
        /* Media Queries para Responsividad */
        @media (max-width: 1024px) {
            .hero h2 {
                font-size: 3rem;
            }
            
            .img1, .img2, .img3, .img4 {
                width: 130px;
            }
            
            .img5 {
                width: 110px;
            }
        }
        
        @media (max-width: 768px) {
            body {
                padding-top: 55px;
            }
            
            header {
                padding: 10px 0;
            }
            
            .logo {
                height: 25px;
            }
            
            .hero h2 {
                font-size: 2.2rem;
                margin-bottom: 30px;
            }
            
            .botones {
                flex-direction: column;
                align-items: center;
                gap: 15px;
            }
            
            .botones button {
                width: 100%;
                max-width: 280px;
                padding: 14px 30px;
            }
            
            /* Ajustar imágenes flotantes para tablets */
            .floating-images {
                display: flex;
                justify-content: space-around;
                flex-wrap: wrap;
            }
            
            .img1, .img2, .img3, .img4 {
                position: relative;
                width: 120px;
                margin: 10px;
            }
            
            .img5 {
                display: none; /* Ocultar la imagen central en tablets */
            }
            
            .wizard-content {
                padding: 30px 15px;
                justify-content: flex-start;
                min-height: auto;
                padding-top: 60px;
            }
            
            .wizard-close-x {
                top: 10px;
                right: 10px;
                font-size: 2rem;
                width: 35px;
                height: 35px;
            }
            
            .wizard-title {
                font-size: 1.7rem;
                margin-bottom: 25px;
            }
            
            .wizard-field {
                margin-bottom: 18px;
            }
            
            .wizard-field input, 
            .wizard-field select, 
            .wizard-field textarea {
                padding: 14px;
                font-size: 16px; /* Previene zoom en iOS */
            }
            
            /* CAMBIO 1: Invertir orden de botones en móviles (Siguiente primero, luego Atrás) */
            .wizard-buttons {
                flex-direction: column-reverse;
                gap: 12px;
                margin-top: 25px;
            }
            
            .wizard-buttons button {
                width: 100%;
                padding: 14px 20px;
            }
            
            /* CAMBIO 2: Ajustar grid para 2 columnas debajo de 740px */
            .product-buttons-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 8px;
            }
            
            .product-button {
                min-height: 65px;
                padding: 10px 8px;
            }
            
            .product-button-content {
                gap: 6px;
            }
            
            .product-button span {
                font-size: 0.85rem;
            }
            
            /* NUEVO: Mejorar controles de cantidad para móviles */
            .quantity-controls {
                gap: 6px;
            }
            
            .quantity-btn {
                width: 32px;
                height: 32px;
                font-size: 1.1rem;
            }
            
            .product-button-quantity {
                width: 45px;
                padding: 8px 5px;
                font-size: 1rem;
                min-height: 32px;
            }
            
            .selectable-button-content {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            
            .quantity-input {
                margin-left: 0;
                width: 100%;
            }
            
            .modal-content {
                padding: 20px 15px;
            }
            
            .modal-buttons {
                flex-direction: column;
            }
            
            .address-fields {
                grid-template-columns: 1fr;
                gap: 12px;
            }
            
            .address-full {
                grid-column: span 1;
            }
            
            .empresa-option {
                padding: 18px 12px;
            }
            
            .radio-button-option,
            .volume-option {
                padding: 14px;
            }
        }
        
        @media (max-width: 480px) {
            .hero h2 {
                font-size: 1.8rem;
                margin-bottom: 25px;
                line-height: 1.2;
            }
            
            header {
                padding: 8px 0;
            }
            
            /* Ajustar imágenes flotantes para móviles */
            .floating-images {
                display: none; /* Ocultar imágenes en móviles muy pequeños */
            }
            
            /* Alternativa: mostrar solo 2 imágenes en móviles */
            
            .img1, .img2, .img3, .img4, .img5 {
                display: none;
            }
            
            .img1, .img2 {
                display: block;
                width: 100px;
                top: auto;
                bottom: 10%;
            }
            
            .img1 {
                left: 5%;
            }
            
            .img2 {
                right: 5%;
            }
            
            
            .wizard-content {
                padding: 25px 12px;
                padding-top: 50px;
            }
            
            .wizard-title {
                font-size: 1.5rem;
                margin-bottom: 20px;
            }
            
            .product-buttons-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .product-button {
                min-height: 60px;
                padding: 8px 6px;
            }
            
            .product-button span {
                font-size: 0.8rem;
            }
            
            /* NUEVO: Ajustar controles de cantidad para móviles pequeños */
            .quantity-btn {
                width: 28px;
                height: 28px;
                font-size: 1rem;
            }
            
            .product-button-quantity {
                width: 40px;
                padding: 7px;
                font-size: 0.9rem;
                min-height: 28px;
            }
            
            .wizard-field input, 
            .wizard-field select, 
            .wizard-field textarea {
                padding: 12px;
            }
            
            .confirmation-options {
                gap: 12px;
            }
            
            .summary-container {
                padding: 15px;
            }
            
            .summary-item {
                font-size: 0.9rem;
            }
            
            .unknown-button {
                padding: 10px 12px;
            }
            
            .modal-overlay {
                padding: 15px;
            }
            
            .modal-content {
                padding: 20px 15px;
            }
            
            .modal-buttons button {
                padding: 10px 15px;
            }
        }
        
        @media (max-width: 360px) {
            .hero h2 {
                font-size: 1.6rem;
            }
            
            .product-buttons-grid {
                grid-template-columns: 1fr;
            }
            
            .botones button {
                max-width: 100%;
            }
            
            /* NUEVO: Ajuste adicional para pantallas muy pequeñas */
            .quantity-btn {
                width: 26px;
                height: 26px;
            }
            
            .product-button-quantity {
                width: 35px;
                padding: 6px;
            }
        }
        
        /* Ajustes para tablets en orientación vertical */
        @media (min-width: 769px) and (max-width: 1024px) and (orientation: portrait) {
            .hero h2 {
                font-size: 2.8rem;
            }
            
            .wizard-content {
                padding: 35px 20px;
            }
            
            .product-buttons-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }
        
        /* Ajustes para tablets en orientación horizontal */
        @media (min-width: 769px) and (max-width: 1024px) and (orientation: landscape) {
            .wizard-content {
                padding: 30px 20px;
                justify-content: center;
            }
            
            /* Ajustar imágenes para landscape */
            .img1, .img2, .img3, .img4 {
                width: 110px;
            }
            
            .img5 {
                width: 90px;
            }
        }
        
        /* Ajustes para dispositivos muy altos */
        @media (min-height: 1000px) {
            .wizard-content {
                justify-content: center;
            }
            
            /* Ajustar posición de imágenes para pantallas altas */
            .img1 {
                top: 20%;
            }
            
            .img2 {
                top: 20%;
            }
            
            .img3 {
                bottom: 25%;
            }
            
            .img4 {
                bottom: 25%;
            }
        }
        
        /* CAMBIO 2: Media query específica para 740px para productos */
        @media (max-width: 740px) {
            .product-buttons-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <!-- Modal de confirmación para cerrar wizard -->
    <div class="modal-overlay" id="close-confirm-modal">
        <div class="modal-content">
            <h3>¿Estás seguro de que deseas salir?</h3>
            <p>Si sales, deberás comenzar con el formulario de nuevo.</p>
            <div class="modal-buttons">
                <button class="modal-cancel" id="modal-cancel">Cancelar</button>
                <button class="modal-confirm" id="modal-confirm">Sí, salir</button>
            </div>
        </div>
    </div>

    <header>
        <img src="assets/images/Recurso 21CHOCOLATE.svg" alt="Huichply" class="logo">
    </header>
    
    <section class="hero">
        <div class="floating-images">
            <img src="assets/images/Recurso 9primer contacto.png" alt="" class="floating-img img1">
            <img src="assets/images/Recurso 8primer contacto.png" alt="" class="floating-img img2">
            <img src="assets/images/Recurso 14primer contacto.png" alt="" class="floating-img img3">
            <img src="assets/images/Recurso 12primer contacto.png" alt="" class="floating-img img4">
            <img src="assets/images/Recurso 10primer contacto.png" alt="" class="floating-img img5">
            <img src="assets/images/Recurso 16primer contacto.png" alt="" class="floating-img img6">
        </div>
        <div class="hero-content">
            <h2>TODO LO QUE ENTRE EN UNA FURGONETA</h2>
            <div class="botones">
                <button id="btn-pide-ya">Pide un Huichply</button>
                <button id="btn-empresas">Empresas</button>
            </div>
        </div>
    </section>
    
    <!-- Wizard: Pide un Huichply - Ahora con selección inicial de servicio -->
    <div id="wizard-pide-ya" class="wizard-container">
        <div class="wizard-content">
            <span class="wizard-close-x" data-wizard="wizard-pide-ya">×</span>
            
            <!-- Paso 0: Selección de tipo de servicio -->
            <div class="wizard-step active" data-step="0">
                <h2 class="wizard-title">Tipo de servicio</h2>
                <p>Selecciona el tipo de servicio que necesitas:</p>
                
                <div class="radio-buttons-container">
                    <label class="radio-button-option" for="servicio-domicilio">
                        <input type="radio" id="servicio-domicilio" name="tipo-servicio" value="domicilio">
                        A un domicilio
                    </label>
                    <label class="radio-button-option" for="servicio-punto-limpio">
                        <input type="radio" id="servicio-punto-limpio" name="tipo-servicio" value="punto-limpio">
                        Punto Limpio
                    </label>
                </div>
                
                <div class="error-message" id="servicio-error">Por favor, selecciona un tipo de servicio</div>
                
                <div class="wizard-buttons">
                    <button class="wizard-close-confirm">Cerrar</button>
                    <button class="wizard-next">Siguiente</button>
                </div>
            </div>
            
            <!-- Paso 1: Nombre -->
            <div class="wizard-step" data-step="1">
                <h2 class="wizard-title">Pide un Huichply</h2>
                <div class="wizard-field">
                    <label for="nombre">Nombre completo *</label>
                    <input type="text" id="nombre" required>
                    <div class="error-message">Por favor, ingresa tu nombre</div>
                </div>
                <div class="wizard-buttons">
                    <button class="wizard-prev">Atrás</button>
                    <button class="wizard-next">Siguiente</button>
                </div>
            </div>
            
            <!-- Paso 2: Productos -->
            <div class="wizard-step" data-step="2">
                <h2 class="wizard-title">¿Qué necesitas transportar?</h2>
                
                <!-- NUEVO DISEÑO DE BOTONES DE PRODUCTOS CON CONTROLES MEJORADOS -->
                <div class="product-buttons-grid">
                    <label class="product-button" for="sofa">
                        <input type="checkbox" id="sofa" class="product-checkbox" data-product="Sofá">
                        <div class="product-button-content">
                            <span>Sofá</span>
                            <div class="quantity-controls">
                                <button type="button" class="quantity-btn quantity-minus">-</button>
                                <input type="number" min="1" value="1" class="product-button-quantity" placeholder="1">
                                <button type="button" class="quantity-btn quantity-plus">+</button>
                            </div>
                        </div>
                    </label>
                    
                    <label class="product-button" for="canape">
                        <input type="checkbox" id="canape" class="product-checkbox" data-product="Canapé">
                        <div class="product-button-content">
                            <span>Canapé</span>
                            <div class="quantity-controls">
                                <button type="button" class="quantity-btn quantity-minus">-</button>
                                <input type="number" min="1" value="1" class="product-button-quantity" placeholder="1">
                                <button type="button" class="quantity-btn quantity-plus">+</button>
                            </div>
                        </div>
                    </label>
                    
                    <label class="product-button" for="literas">
                        <input type="checkbox" id="literas" class="product-checkbox" data-product="Literas">
                        <div class="product-button-content">
                            <span>Literas</span>
                            <div class="quantity-controls">
                                <button type="button" class="quantity-btn quantity-minus">-</button>
                                <input type="number" min="1" value="1" class="product-button-quantity" placeholder="1">
                                <button type="button" class="quantity-btn quantity-plus">+</button>
                            </div>
                        </div>
                    </label>
                    
                    <label class="product-button" for="comedor">
                        <input type="checkbox" id="comedor" class="product-checkbox" data-product="Comedor">
                        <div class="product-button-content">
                            <span>Comedor</span>
                            <div class="quantity-controls">
                                <button type="button" class="quantity-btn quantity-minus">-</button>
                                <input type="number" min="1" value="1" class="product-button-quantity" placeholder="1">
                                <button type="button" class="quantity-btn quantity-plus">+</button>
                            </div>
                        </div>
                    </label>
                    
                    <label class="product-button" for="cama">
                        <input type="checkbox" id="cama" class="product-checkbox" data-product="Cama">
                        <div class="product-button-content">
                            <span>Cama</span>
                            <div class="quantity-controls">
                                <button type="button" class="quantity-btn quantity-minus">-</button>
                                <input type="number" min="1" value="1" class="product-button-quantity" placeholder="1">
                                <button type="button" class="quantity-btn quantity-plus">+</button>
                            </div>
                        </div>
                    </label>
                    
                    <label class="product-button" for="colchones">
                        <input type="checkbox" id="colchones" class="product-checkbox" data-product="Colchones">
                        <div class="product-button-content">
                            <span>Colchones</span>
                            <div class="quantity-controls">
                                <button type="button" class="quantity-btn quantity-minus">-</button>
                                <input type="number" min="1" value="1" class="product-button-quantity" placeholder="1">
                                <button type="button" class="quantity-btn quantity-plus">+</button>
                            </div>
                        </div>
                    </label>
                    
                    <label class="product-button" for="mesa-noche">
                        <input type="checkbox" id="mesa-noche" class="product-checkbox" data-product="Mesa de noche">
                        <div class="product-button-content">
                            <span>Mesa de noche</span>
                            <div class="quantity-controls">
                                <button type="button" class="quantity-btn quantity-minus">-</button>
                                <input type="number" min="1" value="1" class="product-button-quantity" placeholder="1">
                                <button type="button" class="quantity-btn quantity-plus">+</button>
                            </div>
                        </div>
                    </label>
                    
                    <label class="product-button" for="cajas">
                        <input type="checkbox" id="cajas" class="product-checkbox" data-product="Cajas">
                        <div class="product-button-content">
                            <span>Cajas</span>
                            <div class="quantity-controls">
                                <button type="button" class="quantity-btn quantity-minus">-</button>
                                <input type="number" min="1" value="1" class="product-button-quantity" placeholder="1">
                                <button type="button" class="quantity-btn quantity-plus">+</button>
                            </div>
                        </div>
                    </label>
                    
                    <label class="product-button" for="maletas">
                        <input type="checkbox" id="maletas" class="product-checkbox" data-product="Maletas">
                        <div class="product-button-content">
                            <span>Maletas</span>
                            <div class="quantity-controls">
                                <button type="button" class="quantity-btn quantity-minus">-</button>
                                <input type="number" min="1" value="1" class="product-button-quantity" placeholder="1">
                                <button type="button" class="quantity-btn quantity-plus">+</button>
                            </div>
                        </div>
                    </label>
                    
                    <label class="product-button" for="bolsas">
                        <input type="checkbox" id="bolsas" class="product-checkbox" data-product="Bolsas">
                        <div class="product-button-content">
                            <span>Bolsas</span>
                            <div class="quantity-controls">
                                <button type="button" class="quantity-btn quantity-minus">-</button>
                                <input type="number" min="1" value="1" class="product-button-quantity" placeholder="1">
                                <button type="button" class="quantity-btn quantity-plus">+</button>
                            </div>
                        </div>
                    </label>
                    
                    <label class="product-button" for="electrodomesticos">
                        <input type="checkbox" id="electrodomesticos" class="product-checkbox" data-product="Electrodomésticos" data-special="electrodomesticos">
                        <div class="product-button-content">
                            <span>Electrodomésticos</span>
                            <div class="quantity-controls">
                                <button type="button" class="quantity-btn quantity-minus">-</button>
                                <input type="number" min="1" value="1" class="product-button-quantity" placeholder="1">
                                <button type="button" class="quantity-btn quantity-plus">+</button>
                            </div>
                        </div>
                    </label>
                    
                    <label class="product-button" for="otros">
                        <input type="checkbox" id="otros" class="product-checkbox" data-product="Otros" data-special="otros">
                        <div class="product-button-content">
                            <span>Otros</span>
                            <div class="quantity-controls">
                                <button type="button" class="quantity-btn quantity-minus">-</button>
                                <input type="number" min="1" value="1" class="product-button-quantity" placeholder="1">
                                <button type="button" class="quantity-btn quantity-plus">+</button>
                            </div>
                        </div>
                    </label>
                </div>
                
                <!-- Campo para Electrodomésticos -->
                <div class="special-input-container" id="electrodomesticos-container">
                    <div class="wizard-field">
                        <label for="electrodomesticos-desc">Describe los electrodomésticos *</label>
                        <input type="text" id="electrodomesticos-desc" placeholder="Ejemplo: microondas, licuadora, TV 42 pulgadas">
                        <div class="error-message">Por favor, describe los electrodomésticos</div>
                    </div>
                    <div class="special-note">Nota: No transportamos refrigeradoras grandes</div>
                </div>
                
                <!-- Campo para Otros -->
                <div class="special-input-container" id="otros-container">
                    <div class="wizard-field">
                        <label for="otros-desc">Describe qué necesitas transportar *</label>
                        <input type="text" id="otros-desc" placeholder="Ejemplo: bicicleta, escritorio, lámpara">
                        <div class="error-message">Por favor, describe qué necesitas transportar</div>
                    </div>
                </div>
                
                <div class="wizard-field">
                    <label for="comentario-transporte">Comentarios adicionales (opcional)</label>
                    <textarea id="comentario-transporte" rows="3" placeholder="Detalles adicionales sobre lo que transportarás"></textarea>
                </div>
                
                <div class="error-message" id="transport-error">Selecciona al menos un elemento y especifica la cantidad</div>
                
                <div class="wizard-buttons">
                    <button class="wizard-prev">Atrás</button>
                    <button class="wizard-next">Siguiente</button>
                </div>
            </div>
            
            <!-- Paso 3: Peso y medidas -->
            <div class="wizard-step" data-step="3">
                <h2 class="wizard-title">Peso y medidas estimadas (opcional)</h2>
                <p>Desliza para indicar el peso aproximado de lo que transportarás</p>
                <!-- CAMBIO 3: Slider modificado para llegar hasta 300 kg -->
                <input type="range" min="0" max="300" value="0" class="weight-slider" id="weight-slider">
                <div class="weight-value" id="weight-value">0 kg</div>
                
                <!-- CAMBIO 3: Botón "No aplica" en lugar de "No lo sé" -->
                <div class="unknown-button" id="unknown-weight">
                    No aplica
                </div>
                
                <div class="wizard-field">
                    <label for="medidas">Medidas aproximadas (opcional)</label>
                    <input type="text" id="medidas" placeholder="Ej: 120x80x60 cm">
                </div>
                
                <div class="wizard-buttons">
                    <button class="wizard-prev">Atrás</button>
                    <button class="wizard-next">Siguiente</button>
                </div>
            </div>
            
            <!-- Paso 4: Confirmación -->
            <div class="wizard-step" data-step="4" data-tipo-servicio="domicilio">
                <h2 class="wizard-title">Confirmación</h2>
                <p>¿Estás seguro de que todo cabe en una furgoneta?</p>
                <div class="confirmation-options">
                    <div class="confirmation-option">
                        <input type="radio" id="confirm-si" name="confirmacion" value="si">
                        <label for="confirm-si">Sí, estoy seguro</label>
                    </div>
                    <div class="confirmation-option">
                        <input type="radio" id="confirm-no" name="confirmacion" value="no">
                        <label for="confirm-no">No lo estoy</label>
                    </div>
                </div>
                <div class="error-message" id="confirmacion-error">Por favor, selecciona una opción</div>
                <div class="wizard-buttons">
                    <button class="wizard-prev">Atrás</button>
                    <button class="wizard-next">Siguiente</button>
                </div>
            </div>
            
            <!-- Paso 5: Dirección de recogida -->
            <div class="wizard-step" data-step="5" data-tipo-servicio="domicilio">
                <h2 class="wizard-title">Dirección de recogida</h2>
                <div class="wizard-field address-full">
                    <label for="direccion-recogida">Dirección completa *</label>
                    <input type="text" id="direccion-recogida" required placeholder="Calle, número">
                    <div class="error-message">Por favor, ingresa la dirección de recogida</div>
                </div>
                
                <div class="address-fields">
                    <div class="wizard-field">
                        <label for="piso-recogida">Piso</label>
                        <input type="text" id="piso-recogida" placeholder="Piso, puerta, etc.">
                    </div>
                    
                    <div class="wizard-field">
                        <label for="cp-recogida">Código postal *</label>
                        <input type="text" id="cp-recogida" required pattern="[0-9]{5}" placeholder="28001">
                        <div class="error-message">Por favor, ingresa un código postal válido (5 dígitos)</div>
                    </div>
                </div>
                
                <div class="wizard-buttons">
                    <button class="wizard-prev">Atrás</button>
                    <button class="wizard-next">Siguiente</button>
                </div>
            </div>
            
            <!-- Paso 6: Dirección de entrega -->
            <div class="wizard-step" data-step="6" data-tipo-servicio="domicilio">
                <h2 class="wizard-title">Dirección de entrega</h2>
                <div class="wizard-field address-full">
                    <label for="direccion-entrega">Dirección completa *</label>
                    <input type="text" id="direccion-entrega" required placeholder="Calle, número">
                    <div class="error-message">Por favor, ingresa la dirección de entrega</div>
                </div>
                
                <div class="address-fields">
                    <div class="wizard-field">
                        <label for="piso-entrega">Piso</label>
                        <input type="text" id="piso-entrega" placeholder="Piso, puerta, etc.">
                    </div>
                    
                    <div class="wizard-field">
                        <label for="cp-entrega">Código postal *</label>
                        <input type="text" id="cp-entrega" required pattern="[0-9]{5}" placeholder="28001">
                        <div class="error-message">Por favor, ingresa un código postal válido (5 dígitos)</div>
                    </div>
                </div>
                
                <div class="wizard-buttons">
                    <button class="wizard-prev">Atrás</button>
                    <button class="wizard-next">Siguiente</button>
                </div>
            </div>
            
            <!-- Paso 7: Fecha y hora -->
            <div class="wizard-step" data-step="7" data-tipo-servicio="domicilio">
                <h2 class="wizard-title">Fecha y hora</h2>
                <div class="wizard-field">
                    <label for="fecha">Fecha *</label>
                    <input type="date" id="fecha" required>
                    <div class="error-message">Por favor, selecciona una fecha</div>
                </div>
                <div class="wizard-field">
                    <label for="franja-horaria">Franja horaria *</label>
                    <select id="franja-horaria" required>
                        <option value="">Selecciona una franja</option>
                        <option value="mañana">Mañana (9:00 - 14:00)</option>
                        <option value="tarde">Tarde (14:00 - 18:00)</option>
                        <option value="tarde-noche">Tarde-noche (18:00 - 22:00)</option>
                    </select>
                    <div class="error-message">Por favor, selecciona una franja horaria</div>
                </div>
                <div class="wizard-buttons">
                    <button class="wizard-prev">Atrás</button>
                    <button class="wizard-next">Siguiente</button>
                </div>
            </div>
            
            <!-- Paso 8: Medios de contacto -->
            <div class="wizard-step" data-step="8" data-tipo-servicio="domicilio">
                <h2 class="wizard-title">Medios de contacto</h2>
                <p>Selecciona cómo prefieres que contactemos contigo (puedes elegir más de uno):</p>
                
                <!-- CAMBIO 5: Diseño mejorado para medios de contacto -->
                <div class="selectable-buttons">
                    <div class="contacto-option">
                        <label class="contacto-button" for="contacto-whatsapp">
                            <input type="checkbox" id="contacto-whatsapp" class="contacto-checkbox" data-contacto="WhatsApp">
                            <div class="contacto-button-content">
                                <span>WhatsApp</span>
                            </div>
                        </label>
                        <div class="contacto-detalle-container">
                            <input type="text" class="contacto-detalle" placeholder="Número de WhatsApp" data-tipo="whatsapp">
                            <div class="error-message">Por favor, ingresa tu número de WhatsApp</div>
                        </div>
                    </div>
                    
                    <div class="contacto-option">
                        <label class="contacto-button" for="contacto-email">
                            <input type="checkbox" id="contacto-email" class="contacto-checkbox" data-contacto="Email">
                            <div class="contacto-button-content">
                                <span>Email</span>
                            </div>
                        </label>
                        <div class="contacto-detalle-container">
                            <input type="email" class="contacto-detalle" placeholder="ejemplo@dominio.com" data-tipo="email">
                            <div class="error-message">Por favor, ingresa un email válido</div>
                        </div>
                    </div>
                    
                    <div class="contacto-option">
                        <label class="contacto-button" for="contacto-llamada">
                            <input type="checkbox" id="contacto-llamada" class="contacto-checkbox" data-contacto="Llamada telefónica">
                            <div class="contacto-button-content">
                                <span>Llamada telefónica</span>
                            </div>
                        </label>
                        <div class="contacto-detalle-container">
                            <input type="text" class="contacto-detalle" placeholder="Número de teléfono" data-tipo="llamada">
                            <div class="error-message">Por favor, ingresa tu número de teléfono</div>
                        </div>
                    </div>
                </div>
                
                <div class="error-message" id="contacto-error">Selecciona al menos un medio de contacto</div>
                
                <div class="wizard-buttons">
                    <button class="wizard-prev">Atrás</button>
                    <button class="wizard-next">Siguiente</button>
                </div>
            </div>
            
            <!-- Paso 9: Resumen -->
            <div class="wizard-step" data-step="9" data-tipo-servicio="domicilio">
                <h2 class="wizard-title">Resumen</h2>
                <div id="resumen-pedido-domicilio" class="summary-container"></div>
                <div class="wizard-buttons">
                    <button class="wizard-prev">Atrás</button>
                    <button class="wizard-next" id="finalizar-pedido-domicilio">Enviar solicitud</button>
                </div>
            </div>
            
            <!-- Paso 10: Éxito -->
            <div class="wizard-step" data-step="10" data-tipo-servicio="domicilio">
                <div class="success-message">
                    <div class="success-icon">✓</div>
                    <h2 class="wizard-title">¡Solicitud enviada!</h2>
                    <p>Le responderemos en menos de 15 minutos.</p>
                    <div class="wizard-buttons">
                        <button class="wizard-close">Volver a la página principal</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Wizard: Selección de tipo de empresa -->
    <div id="wizard-empresa-seleccion" class="wizard-container">
        <div class="wizard-content">
            <span class="wizard-close-x" data-wizard="wizard-empresa-seleccion">×</span>
            <div class="wizard-step active" data-step="1">
                <h2 class="wizard-title">Empresas</h2>
                <p>Selecciona una opción:</p>
                
                <div class="empresa-options">
                    <div class="empresa-option" data-option="afiliado">
                        ¿Eres afiliado?
                    </div>
                    <div class="empresa-option" data-option="afiliacion">
                        ¿Quieres afiliarte?
                    </div>
                </div>
                
                <div class="wizard-buttons">
                    <button class="wizard-close-confirm">Cerrar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Wizard: Empresas (Afiliados) -->
    <div id="wizard-empresas" class="wizard-container">
        <div class="wizard-content">
            <span class="wizard-close-x" data-wizard="wizard-empresas">×</span>
            <div class="wizard-step active" data-step="1">
                <h2 class="wizard-title">Afiliados</h2>
                <div class="wizard-field">
                    <label for="codigo-cliente">Código de cliente (8 dígitos) *</label>
                    <input type="text" id="codigo-cliente" pattern="[0-9]{8}" required placeholder="12345678">
                    <div class="error-message">El código debe tener 8 dígitos numéricos</div>
                </div>
                <div class="wizard-buttons">
                    <button class="wizard-close-confirm">Cerrar</button>
                    <button class="wizard-next">Siguiente</button>
                </div>
            </div>
            
            <div class="wizard-step" data-step="2">
                <h2 class="wizard-title">Datos del cliente</h2>
                <div class="wizard-field">
                    <label for="nombre-afiliado">Nombre del cliente *</label>
                    <input type="text" id="nombre-afiliado" required>
                    <div class="error-message">Por favor, ingresa el nombre del cliente</div>
                </div>
                <div class="wizard-field">
                    <label for="telefono-afiliado">Número de teléfono *</label>
                    <input type="tel" id="telefono-afiliado" required pattern="[0-9]*">
                    <div class="error-message">Por favor, ingresa un número de teléfono válido (solo números)</div>
                </div>
                <div class="wizard-buttons">
                    <button class="wizard-prev">Atrás</button>
                    <button class="wizard-next">Siguiente</button>
                </div>
            </div>
            
            <div class="wizard-step" data-step="3">
                <h2 class="wizard-title">Direcciones</h2>
                <div class="wizard-field address-full">
                    <label for="afiliado-recogida">Dirección de recogida *</label>
                    <input type="text" id="afiliado-recogida" required>
                    <div class="error-message">Por favor, ingresa la dirección de recogida</div>
                </div>
                
                <div class="address-fields">
                    <div class="wizard-field">
                        <label for="piso-recogida-afiliado">Piso</label>
                        <input type="text" id="piso-recogida-afiliado" placeholder="Piso, puerta, etc.">
                    </div>
                    
                    <div class="wizard-field">
                        <label for="cp-recogida-afiliado">Código postal *</label>
                    <input type="text" id="cp-recogida-afiliado" required pattern="[0-9]{5}" placeholder="28001">
                        <div class="error-message">Por favor, ingresa un código postal válido (5 dígitos)</div>
                    </div>
                </div>
                
                <div class="wizard-field address-full">
                    <label for="afiliado-entrega">Dirección de entrega *</label>
                    <input type="text" id="afiliado-entrega" required>
                    <div class="error-message">Por favor, ingresa la dirección de entrega</div>
                </div>
                
                <div class="address-fields">
                    <div class="wizard-field">
                        <label for="piso-entrega-afiliado">Piso</label>
                        <input type="text" id="piso-entrega-afiliado" placeholder="Piso, puerta, etc.">
                    </div>
                    
                    <div class="wizard-field">
                        <label for="cp-entrega-afiliado">Código postal *</label>
                        <input type="text" id="cp-entrega-afiliado" required pattern="[0-9]{5}" placeholder="28001">
                        <div class="error-message">Por favor, ingresa un código postal válido (5 dígitos)</div>
                    </div>
                </div>
                
                <div class="wizard-buttons">
                    <button class="wizard-prev">Atrás</button>
                    <button class="wizard-next">Siguiente</button>
                </div>
            </div>
            
            <div class="wizard-step" data-step="4">
                <h2 class="wizard-title">Fecha and hora</h2>
                <div class="wizard-field">
                    <label for="afiliado-fecha">Fecha de recogida *</label>
                    <input type="date" id="afiliado-fecha" required>
                    <div class="error-message">Por favor, selecciona una fecha</div>
                </div>
                <div class="wizard-field">
                    <label for="afiliado-hora">Hora de recogida *</label>
                    <input type="time" id="afiliado-hora" required>
                    <div class="error-message">Por favor, selecciona una hora</div>
                </div>
                <div class="wizard-buttons">
                    <button class="wizard-prev">Atrás</button>
                    <button class="wizard-next">Siguiente</button>
                </div>
            </div>
            
            <div class="wizard-step" data-step="5">
                <h2 class="wizard-title">Tipo de producto</h2>
                <div class="radio-buttons-container">
                    <label class="radio-button-option" for="producto-acordado">
                        <input type="radio" id="producto-acordado" name="tipo-producto" value="acordado">
                        Producto acordado
                    </label>
                    <label class="radio-button-option" for="devolucion">
                        <input type="radio" id="devolucion" name="tipo-producto" value="devolucion">
                        Devolución
                    </label>
                    <label class="radio-button-option" for="producto-no-acordado">
                        <input type="radio" id="producto-no-acordado" name="tipo-producto" value="no-acordado">
                        Producto no acordado
                    </label>
                </div>
                
                <!-- Campo para especificar producto no acordado -->
                <div class="special-input-container" id="producto-no-acordado-container">
                    <div class="wizard-field">
                        <label for="producto-no-acordado-desc">Especifica qué producto es *</label>
                        <input type="text" id="producto-no-acordado-desc" placeholder="Describe el producto">
                        <div class="error-message">Por favor, describe el producto</div>
                    </div>
                </div>
                
                <div class="error-message" id="tipo-producto-error">Por favor, selecciona el tipo de producto</div>
                <div class="wizard-buttons">
                    <button class="wizard-prev">Atrás</button>
                    <button class="wizard-next">Siguiente</button>
                </div>
            </div>
            
            <div class="wizard-step" data-step="6">
                <h2 class="wizard-title">Resumen y confirmación</h2>
                <div id="resumen-afiliado" class="summary-container"></div>
                <div class="wizard-buttons">
                    <button class="wizard-prev">Atrás</button>
                    <button class="wizard-next" id="finalizar-pedido-afiliado">Enviar solicitud</button>
                </div>
            </div>
            
            <div class="wizard-step" data-step="7">
                <div class="success-message">
                    <div class="success-icon">✓</div>
                    <h2 class="wizard-title">¡Solicitud enviada!</h2>
                    <p>Le responderemos en menos de 15 minutos.</p>
                    <div class="wizard-buttons">
                        <button class="wizard-close">Volver a la página principal</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Wizard: Afiliación -->
    <div id="wizard-afiliacion" class="wizard-container">
        <div class="wizard-content">
            <span class="wizard-close-x" data-wizard="wizard-afiliacion">×</span>
            <div class="wizard-step active" data-step="1">
                <h2 class="wizard-title">Afiliación</h2>
                <div class="wizard-field">
                    <label for="nombre-empresa">Nombre de la empresa *</label>
                    <input type="text" id="nombre-empresa" required>
                    <div class="error-message">Por favor, ingresa el nombre de la empresa</div>
                </div>
                <div class="wizard-field">
                    <label for="cif">CIF (9 dígitos) *</label>
                    <input type="text" id="cif" pattern="[A-Za-z]{1}[0-9]{7}[A-Za-z]{1}" required placeholder="A12345678">
                    <div class="error-message">El CIF debe tener el formato: Letra + 7 números + Letra</div>
                </div>
                <div class="wizard-field">
                    <label for="responsable">Responsable *</label>
                    <input type="text" id="responsable" required>
                    <div class="error-message">Por favor, ingresa el responsable</div>
                </div>
                <div class="wizard-field">
                    <label for="telefono-empresa">Teléfono *</label>
                    <input type="tel" id="telefono-empresa" required pattern="[0-9]*">
                    <div class="error-message">Por favor, ingresa un número de teléfono válido (solo números)</div>
                </div>
                <div class="wizard-field">
                    <label for="email-empresa">Email *</label>
                    <input type="email" id="email-empresa" required>
                    <div class="error-message">Por favor, ingresa un email válido</div>
                </div>
                <div class="wizard-buttons">
                    <button class="wizard-close-confirm">Cerrar</button>
                    <button class="wizard-next">Siguiente</button>
                </div>
            </div>
            
            <div class="wizard-step" data-step="2">
                <h2 class="wizard-title">Dirección</h2>
                <div class="wizard-field address-full">
                    <label for="direccion-empresa">Dirección completa *</label>
                    <input type="text" id="direccion-empresa" required placeholder="Calle, número">
                    <div class="error-message">Por favor, ingresa la dirección</div>
                </div>
                
                <div class="address-fields">
                    <div class="wizard-field">
                        <label for="piso-empresa">Piso</label>
                        <input type="text" id="piso-empresa" placeholder="Piso, puerta, etc.">
                    </div>
                    
                    <div class="wizard-field">
                        <label for="cp-empresa">Código postal *</label>
                        <input type="text" id="cp-empresa" required pattern="[0-9]{5}" placeholder="28001">
                        <div class="error-message">Por favor, ingresa un código postal válido (5 dígitos)</div>
                    </div>
                </div>
                
                <div class="wizard-buttons">
                    <button class="wizard-prev">Atrás</button>
                    <button class="wizard-next">Siguiente</button>
                </div>
            </div>
            
            <div class="wizard-step" data-step="3">
                <h2 class="wizard-title">Volumen de envíos</h2>
                <p>Selecciona el volumen aproximado de envíos mensuales:</p>
                <div class="volume-options">
                    <label class="volume-option" for="volumen-1-10">
                        <input type="radio" id="volumen-1-10" name="volumen-envios" value="1-10">
                        1 - 10
                    </label>
                    <label class="volume-option" for="volumen-10-20">
                        <input type="radio" id="volumen-10-20" name="volumen-envios" value="10-20">
                        10 - 20
                    </label>
                    <label class="volume-option" for="volumen-20-30">
                        <input type="radio" id="volumen-20-30" name="volumen-envios" value="20-30">
                        20 - 30
                    </label>
                    <label class="volume-option" for="volumen-otro">
                        <input type="radio" id="volumen-otro" name="volumen-envios" value="otro">
                        Otro
                    </label>
                </div>
                
                <!-- Campo para especificar otro volumen -->
                <div class="special-input-container" id="volumen-otro-container">
                    <div class="wizard-field">
                        <label for="volumen-otro-desc">Especifica el volumen *</label>
                        <input type="number" id="volumen-otro-desc" min="1" placeholder="Número de envíos mensuales">
                        <div class="error-message">Por favor, ingresa un número válido</div>
                    </div>
                </div>
                
                <div class="error-message" id="volumen-error">Por favor, selecciona un volumen de envíos</div>
                <div class="wizard-buttons">
                    <button class="wizard-prev">Atrás</button>
                    <button class="wizard-next">Siguiente</button>
                </div>
            </div>
            
            <div class="wizard-step" data-step="4">
                <h2 class="wizard-title">Resumen and confirmación</h2>
                <div id="resumen-afiliacion" class="summary-container"></div>
                <div class="wizard-buttons">
                    <button class="wizard-prev">Atrás</button>
                    <button class="wizard-next" id="finalizar-afiliacion">Enviar solicitud</button>
                </div>
            </div>
            
            <div class="wizard-step" data-step="5">
                <div class="success-message">
                    <div class="success-icon">✓</div>
                    <h2 class="wizard-title">¡Solicitud enviada!</h2>
                    <p>Se le mandará un coste fijo basado en los datos proporcionados.</p>
                    <div class="wizard-buttons">
                        <button class="wizard-close">Volver a la página principal</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Wizard: Punto Limpio -->
    <div id="wizard-punto-limpio" class="wizard-container">
        <div class="wizard-content">
            <span class="wizard-close-x" data-wizard="wizard-punto-limpio">×</span>
            
            <!-- Paso inicial para Punto Limpio -->
            <div class="wizard-step active" data-step="20">
                <h2 class="wizard-title">Estado del producto</h2>
                <div class="wizard-field">
                    <label for="estado-producto-pl">Describe el estado de lo que vas a transportar *</label>
                    <textarea id="estado-producto-pl" rows="3" required placeholder="Ej: Muebles en buen estado, electrodomésticos funcionando, etc."></textarea>
                    <div class="error-message">Por favor, describe el estado de los productos</div>
                </div>
                
                <div class="wizard-buttons">
                    <button class="wizard-close-confirm">Cerrar</button>
                    <button class="wizard-next">Siguiente</button>
                </div>
            </div>

            <div class="wizard-step" data-step="21">
                <h2 class="wizard-title">Dirección de recogida</h2>
                <div class="wizard-field address-full">
                    <label for="direccion-recogida-pl">Dirección completa *</label>
                    <input type="text" id="direccion-recogida-pl" required placeholder="Calle, número">
                    <div class="error-message">Por favor, ingresa la dirección de recogida</div>
                </div>
                
                <div class="address-fields">
                    <div class="wizard-field">
                        <label for="piso-recogida-pl">Piso</label>
                        <input type="text" id="piso-recogida-pl" placeholder="Piso, puerta, etc.">
                    </div>
                    
                    <div class="wizard-field">
                        <label for="cp-recogida-pl">Código postal *</label>
                        <input type="text" id="cp-recogida-pl" required pattern="[0-9]{5}" placeholder="28001">
                        <div class="error-message">Por favor, ingresa un código postal válido (5 dígitos)</div>
                    </div>
                </div>
                
                <div class="wizard-buttons">
                    <button class="wizard-prev">Atrás</button>
                    <button class="wizard-next">Siguiente</button>
                </div>
            </div>

            <div class="wizard-step" data-step="22">
                <h2 class="wizard-title">Fecha y hora</h2>
                <div class="wizard-field">
                    <label for="fecha-pl">Fecha *</label>
                    <input type="date" id="fecha-pl" required min="2024-03-16">
                    <div class="error-message">Por favor, selecciona una fecha</div>
                </div>
                <div class="wizard-field">
                    <label for="franja-horaria-pl">Franja horaria *</label>
                    <select id="franja-horaria-pl" required>
                        <option value="">Selecciona una franja</option>
                        <option value="mañana">Mañana (9:00 - 14:00)</option>
                        <option value="tarde">Tarde (14:00 - 18:00)</option>
                        <option value="tarde-noche">Tarde-noche (18:00 - 22:00)</option>
                    </select>
                    <div class="error-message">Por favor, selecciona una franja horaria</div>
                </div>
                <div class="wizard-buttons">
                    <button class="wizard-prev">Atrás</button>
                    <button class="wizard-next">Siguiente</button>
                </div>
            </div>

            <div class="wizard-step" data-step="23">
                <h2 class="wizard-title">Medios de contacto</h2>
                <p>Selecciona cómo prefieres que contactemos contigo (puedes elegir más de uno):</p>
                
                <div class="selectable-buttons">
                    <div class="contacto-option">
                        <label class="contacto-button" for="contacto-whatsapp-pl">
                            <input type="checkbox" id="contacto-whatsapp-pl" class="contacto-checkbox-pl" data-contacto="WhatsApp">
                            <div class="contacto-button-content">
                                <span>WhatsApp</span>
                            </div>
                        </label>
                        <div class="contacto-detalle-container">
                            <input type="text" class="contacto-detalle-pl" placeholder="Número de WhatsApp" data-tipo="whatsapp">
                            <div class="error-message">Por favor, ingresa tu número de WhatsApp</div>
                        </div>
                    </div>
                    
                    <div class="contacto-option">
                        <label class="contacto-button" for="contacto-email-pl">
                            <input type="checkbox" id="contacto-email-pl" class="contacto-checkbox-pl" data-contacto="Email">
                            <div class="contacto-button-content">
                                <span>Email</span>
                            </div>
                        </label>
                        <div class="contacto-detalle-container">
                            <input type="email" class="contacto-detalle-pl" placeholder="ejemplo@dominio.com" data-tipo="email">
                            <div class="error-message">Por favor, ingresa un email válido</div>
                        </div>
                    </div>
                    
                    <div class="contacto-option">
                        <label class="contacto-button" for="contacto-llamada-pl">
                            <input type="checkbox" id="contacto-llamada-pl" class="contacto-checkbox-pl" data-contacto="Llamada telefónica">
                            <div class="contacto-button-content">
                                <span>Llamada telefónica</span>
                            </div>
                        </label>
                        <div class="contacto-detalle-container">
                            <input type="text" class="contacto-detalle-pl" placeholder="Número de teléfono" data-tipo="llamada">
                            <div class="error-message">Por favor, ingresa tu número de teléfono</div>
                        </div>
                    </div>
                </div>
                
                <div class="error-message" id="contacto-error-pl">Selecciona al menos un medio de contacto</div>
                
                <div class="wizard-buttons">
                    <button class="wizard-prev">Atrás</button>
                    <button class="wizard-next">Siguiente</button>
                </div>
            </div>

            <div class="wizard-step" data-step="24">
                <h2 class="wizard-title">Resumen</h2>
                <div id="resumen-pedido-punto-limpio" class="summary-container"></div>
                <div class="wizard-buttons">
                    <button class="wizard-prev">Atrás</button>
                    <button class="wizard-next" id="finalizar-pedido-pl">Enviar solicitud</button>
                </div>
            </div>

            <div class="wizard-step" data-step="25">
                <div class="success-message">
                    <div class="success-icon">✓</div>
                    <h2 class="wizard-title">¡Solicitud enviada!</h2>
                    <p>Le responderemos en menos de 15 minutos.</p>
                    <div class="wizard-buttons">
                        <button class="wizard-close">Volver a la página principal</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

<script>
// NUEVO CÓDIGO JAVASCRIPT SIMPLIFICADO Y MEJORADO

$(document).ready(function() {
    // Variables globales
    let currentWizard = null;
    let currentStep = 0;
    let formData = {};
    
    // Configuración de los wizards y sus pasos
    const wizardsConfig = {
        'wizard-pide-ya': {
            steps: 11,
            serviceType: null,
            flow: 'consumer'
        },
        'wizard-empresas': {
            steps: 7,
            flow: 'business'
        },
        'wizard-afiliacion': {
            steps: 7,
            flow: 'affiliation'
        },
        'wizard-punto-limpio': {
            steps: 6,
            flow: 'clean-point'
        }
    };
    
    // Inicialización
    function init() {
        setupEventListeners();
        setupTouchEvents();
        setupNumericValidation();
        
        // Inicializar fecha mínima para Punto Limpio
        const hoy = new Date().toISOString().split('T')[0];
        $('#fecha-pl').attr('min', hoy);
    }
    
    // Configurar event listeners
    function setupEventListeners() {
        // Botones principales
        $('#btn-pide-ya').click(() => openWizard('wizard-pide-ya'));
        $('#btn-empresas').click(() => openWizard('wizard-empresa-seleccion'));
        
        // Navegación wizard
        $('.wizard-next').click(handleNext);
        $('.wizard-prev').click(handlePrevious);
        
        // Cerrar wizards
        $('.wizard-close-x').click(handleCloseWizard);
        $('.wizard-close').click(handleCloseWizard);
        $('.wizard-close-confirm').click(() => $('#close-confirm-modal').show());
        
        // Modal de confirmación
        $('#modal-cancel').click(() => $('#close-confirm-modal').hide());
        $('#modal-confirm').click(confirmCloseWizard);
        
        // Selección de tipo de empresa
        $('.empresa-option').click(handleEmpresaOption);
        
        // Controles de cantidad
        $(document).on('click', '.quantity-plus', handleQuantityChange);
        $(document).on('click', '.quantity-minus', handleQuantityChange);
        $('.product-button-quantity').change(validateQuantityInput);
        
        // Botones de productos
        $('.product-button').click(handleProductSelection);
        
        // Botones de contacto
        $('.contacto-button').click(handleContactSelection);
        
        // Botones de opción
        $('.radio-button-option, .volume-option').click(handleOptionSelection);
        
        // Slider de peso
        $('#weight-slider').on('input', updateWeightValue);
        $('#unknown-weight').click(resetWeight);
        
        // Validación de teléfono
        $('input[type="tel"]').on('input', validatePhoneInput);
    }
    
    // Configurar eventos táctiles
    function setupTouchEvents() {
        const touchElements = 'button, .product-button, .empresa-option, .radio-button-option, .volume-option, .quantity-btn, .contacto-button';
        
        $(touchElements).on('touchstart', function() {
            $(this).addClass('touch-active');
        }).on('touchend', function() {
            $(this).removeClass('touch-active');
        });
    }
    
    // Configurar validación numérica
    function setupNumericValidation() {
        $('input[type="tel"], .numeric-input').on('input', function() {
            this.value = this.value.replace(/[^0-9]/g, '');
        });
    }
    
    // Abrir wizard
    function openWizard(wizardId) {
        // Cerrar wizard actual si hay uno abierto
        if (currentWizard) {
            $(`#${currentWizard}`).hide();
        }
        
        // Mostrar wizard seleccionado
        $(`#${wizardId}`).show();
        currentWizard = wizardId;
        
        // Reiniciar estado
        resetWizard(wizardId);
    }
    
    // Reiniciar wizard
    function resetWizard(wizardId) {
        const wizard = $(`#${wizardId}`);
        
        // Ocultar todos los pasos y mostrar el primero
        wizard.find('.wizard-step').removeClass('active');
        wizard.find('.wizard-step:first').addClass('active');
        currentStep = 0;
        
        // Limpiar campos
        wizard.find('input, select, textarea').not('[type="button"]').val('');
        wizard.find('.input-error').removeClass('input-error');
        
        // Reiniciar selecciones
        wizard.find('.product-button, .radio-button-option, .volume-option, .contacto-button').removeClass('selected');
        wizard.find('input[type="checkbox"], input[type="radio"]').prop('checked', false);
        
        // Reiniciar cantidades
        wizard.find('.product-button-quantity').val('1');
        
        // Ocultar mensajes de error
        wizard.find('.error-message').hide();
        
        // Ocultar campos especiales
        $('.special-input-container, .contacto-detalle-container').hide();
        
        // Reiniciar datos del formulario
        formData = {};
    }
    
    // Manejar siguiente paso
    function handleNext() {
        const stepElement = $(this).closest('.wizard-step');
        const currentStepIndex = parseInt(stepElement.data('step'));
        
        // Validar paso actual
        if (!validateStep(stepElement)) {
            return;
        }
        
        // Guardar datos del paso actual
        saveStepData(stepElement);
        
        // Determinar el siguiente paso
        let nextStepIndex = currentStepIndex + 1;
        
        // Lógica especial para el wizard principal
        if (currentWizard === 'wizard-pide-ya' && currentStepIndex === 0) {
            const serviceType = $('input[name="tipo-servicio"]:checked').val();
            wizardsConfig['wizard-pide-ya'].serviceType = serviceType;
            
            if (serviceType === 'punto-limpio') {
                // Cambiar al wizard de punto limpio
                $('#wizard-pide-ya').hide();
                $('#wizard-punto-limpio').show();
                currentWizard = 'wizard-punto-limpio';
                resetWizard('wizard-punto-limpio');
                return;
            }
        }
        
        // Navegar al siguiente paso
        navigateToStep(nextStepIndex);
        
        // Acciones especiales para pasos específicos
        if (currentWizard === 'wizard-pide-ya' && nextStepIndex === 10) {
            generateResumenPedidoDomicilio();
        } else if (currentWizard === 'wizard-punto-limpio' && nextStepIndex === 5) {
            generateResumenPuntoLimpio();
        } else if (currentWizard === 'wizard-empresas' && nextStepIndex === 6) {
            generateResumenAfiliado();
        } else if (currentWizard === 'wizard-afiliacion' && nextStepIndex === 6) {
            generateResumenAfiliacion();
        }
    }
    
    // Manejar paso anterior
    function handlePrevious() {
        const stepElement = $(this).closest('.wizard-step');
        const currentStepIndex = parseInt(stepElement.data('step'));
        
        // Navegar al paso anterior
        navigateToStep(currentStepIndex - 1);
    }
    
    // Navegar a un paso específico
    function navigateToStep(stepIndex) {
        const wizard = $(`#${currentWizard}`);
        
        // Ocultar paso actual
        wizard.find('.wizard-step.active').removeClass('active');
        
        // Mostrar paso solicitado
        wizard.find(`.wizard-step[data-step="${stepIndex}"]`).addClass('active');
        
        // Actualizar estado
        currentStep = stepIndex;
    }
    
    // Validar paso actual
    function validateStep(stepElement) {
        let isValid = true;
        const stepIndex = parseInt(stepElement.data('step'));
        
        // Ocultar mensajes de error previos
        stepElement.find('.error-message').hide();
        stepElement.find('.input-error').removeClass('input-error');
        
        // Validar campos requeridos
        stepElement.find('input[required], select[required], textarea[required]').each(function() {
            if (!$(this).val().trim()) {
                markFieldAsInvalid($(this), 'Este campo es obligatorio');
                isValid = false;
                return false;
            }
            
            // Validaciones específicas por tipo de campo
            if ($(this).attr('type') === 'email') {
                if (!isValidEmail($(this).val())) {
                    markFieldAsInvalid($(this), 'Ingresa un email válido');
                    isValid = false;
                    return false;
                }
            }
            
            if ($(this).attr('pattern')) {
                const pattern = new RegExp($(this).attr('pattern'));
                if (!pattern.test($(this).val())) {
                    markFieldAsInvalid($(this), 'El formato no es válido');
                    isValid = false;
                    return false;
                }
            }
        });
        
        if (!isValid) return false;
        
        // Validaciones específicas por paso
        switch (currentWizard) {
            case 'wizard-pide-ya':
                return validatePideYaStep(stepElement, stepIndex);
            case 'wizard-empresas':
                return validateEmpresasStep(stepElement, stepIndex);
            case 'wizard-afiliacion':
                return validateAfiliacionStep(stepElement, stepIndex);
            case 'wizard-punto-limpio':
                return validatePuntoLimpioStep(stepElement, stepIndex);
            default:
                return true;
        }
    }
    
    // Guardar datos del paso actual
    function saveStepData(stepElement) {
        const stepIndex = parseInt(stepElement.data('step'));
        
        // Recopilar datos de todos los campos del paso
        stepElement.find('input, select, textarea').each(function() {
            const fieldName = $(this).attr('id');
            const fieldValue = $(this).val();
            
            if (fieldName) {
                formData[fieldName] = fieldValue;
            }
        });
        
        // Guardar selecciones de productos
        if (stepIndex === 2 && currentWizard === 'wizard-pide-ya') {
            formData.productos = [];
            $('.product-checkbox:checked').each(function() {
                const product = {
                    nombre: $(this).data('product'),
                    cantidad: $(this).closest('.product-button').find('.product-button-quantity').val()
                };
                
                // Agregar descripción para productos especiales
                if ($(this).attr('id') === 'electrodomesticos') {
                    product.descripcion = $('#electrodomesticos-desc').val();
                } else if ($(this).attr('id') === 'otros') {
                    product.descripcion = $('#otros-desc').val();
                }
                
                formData.productos.push(product);
            });
        }
        
        // Guardar medios de contacto seleccionados
        if ((stepIndex === 9 && currentWizard === 'wizard-pide-ya') || 
            (stepIndex === 4 && currentWizard === 'wizard-punto-limpio')) {
            formData.mediosContacto = [];
            $('.contacto-checkbox:checked, .contacto-checkbox-pl:checked').each(function() {
                const contacto = {
                    tipo: $(this).data('contacto'),
                    valor: $(this).closest('.contacto-option').find('.contacto-detalle, .contacto-detalle-pl').val()
                };
                formData.mediosContacto.push(contacto);
            });
        }
    }
    
    // Funciones de validación específicas para cada wizard
    function validatePideYaStep(stepElement, stepIndex) {
        let isValid = true;
        
        switch (stepIndex) {
            case 0: // Selección de tipo de servicio
                if (!$('input[name="tipo-servicio"]:checked').length) {
                    $('#servicio-error').show();
                    isValid = false;
                }
                break;
                
            case 2: // Selección de productos
                if ($('.product-checkbox:checked').length === 0) {
                    $('#transport-error').show();
                    isValid = false;
                }
                
                // Validar campos especiales si están visibles
                if ($('#electrodomesticos-container:visible').length) {
                    if (!$('#electrodomesticos-desc').val().trim()) {
                        markFieldAsInvalid($('#electrodomesticos-desc'), 'Describe los electrodomésticos');
                        isValid = false;
                    }
                }
                
                if ($('#otros-container:visible').length) {
                    if (!$('#otros-desc').val().trim()) {
                        markFieldAsInvalid($('#otros-desc'), 'Describe qué necesitas transportar');
                        isValid = false;
                    }
                }
                break;
                
            case 5: // Confirmación
                if (!$('input[name="confirmacion"]:checked').length) {
                    $('#confirmacion-error').show();
                    isValid = false;
                }
                break;
                
            case 9: // Medios de contacto
                const contactosSeleccionados = $('.contacto-checkbox:checked');
                if (contactosSeleccionados.length === 0) {
                    $('#contacto-error').show();
                    isValid = false;
                } else {
                    contactosSeleccionados.each(function() {
                        const detalleInput = $(this).closest('.contacto-option').find('.contacto-detalle');
                        if (!detalleInput.val().trim()) {
                            markFieldAsInvalid(detalleInput, 'Este campo es obligatorio');
                            isValid = false;
                        } else if ($(this).attr('id') === 'contacto-email') {
                            if (!isValidEmail(detalleInput.val())) {
                                markFieldAsInvalid(detalleInput, 'Ingresa un email válido');
                                isValid = false;
                            }
                        } else if ($(this).attr('id') === 'contacto-whatsapp' || $(this).attr('id') === 'contacto-llamada') {
                            if (!isValidPhone(detalleInput.val())) {
                                markFieldAsInvalid(detalleInput, 'Ingresa un número válido');
                                isValid = false;
                            }
                        }
                    });
                }
                break;
        }
        
        return isValid;
    }
    
    // Validación para wizard de empresas
    function validateEmpresasStep(stepElement, stepIndex) {
        let isValid = true;
        
        switch (stepIndex) {
            case 1: // Código de cliente
                const codigoCliente = $('#codigo-cliente');
                if (!codigoCliente.val().trim() || !/^\d{8}$/.test(codigoCliente.val())) {
                    markFieldAsInvalid(codigoCliente, 'El código debe tener 8 dígitos numéricos');
                    isValid = false;
                }
                break;
                
            case 5: // Tipo de producto
                if (!$('input[name="tipo-producto"]:checked').length) {
                    $('#tipo-producto-error').show();
                    isValid = false;
                }
                
                // Validar campo de producto no acordado si está visible
                if ($('#producto-no-acordado-container:visible').length) {
                    const productoInput = $('#producto-no-acordado-desc');
                    if (!productoInput.val().trim()) {
                        markFieldAsInvalid(productoInput, 'Describe el producto');
                        isValid = false;
                    }
                }
                break;
        }
        
        return isValid;
    }
    
    // Validación para wizard de afiliación
    function validateAfiliacionStep(stepElement, stepIndex) {
        let isValid = true;
        
        switch (stepIndex) {
            case 2: // CIF
                const cif = $('#cif');
                if (!cif.val().trim() || !/^[A-Za-z]{1}[0-9]{7}[A-Za-z]{1}$/.test(cif.val())) {
                    markFieldAsInvalid(cif, 'El CIF debe tener el formato: Letra + 7 números + Letra');
                    isValid = false;
                }
                break;
                
            case 5: // Volumen de envíos
                if (!$('input[name="volumen-envios"]:checked').length) {
                    $('#volumen-error').show();
                    isValid = false;
                }
                
                // Validar campo de volumen otro si está visible
                if ($('#volumen-otro-container:visible').length) {
                    const volumenInput = $('#volumen-otro-desc');
                    if (!volumenInput.val().trim() || parseInt(volumenInput.val()) <= 0) {
                        markFieldAsInvalid(volumenInput, 'Ingresa un número válido');
                        isValid = false;
                    }
                }
                break;
        }
        
        return isValid;
    }
    
    // Validación para wizard de punto limpio
    function validatePuntoLimpioStep(stepElement, stepIndex) {
        let isValid = true;
        
        switch (stepIndex) {
            case 0: // Estado del producto
                const estadoProducto = $('#estado-producto-pl');
                if (!estadoProducto.val().trim()) {
                    markFieldAsInvalid(estadoProducto, 'Describe el estado de los productos');
                    isValid = false;
                }
                break;
                
            case 1: // Dirección de recogida
                const direccionRecogida = $('#direccion-recogida-pl');
                if (!direccionRecogida.val().trim()) {
                    markFieldAsInvalid(direccionRecogida, 'Ingresa la dirección de recogida');
                    isValid = false;
                }
                
                const cpRecogida = $('#cp-recogida-pl');
                if (!cpRecogida.val().trim() || !/^\d{5}$/.test(cpRecogida.val())) {
                    markFieldAsInvalid(cpRecogida, 'Ingresa un código postal válido');
                    isValid = false;
                }
                break;
                
            case 2: // Fecha y hora
                const fecha = $('#fecha-pl');
                if (!fecha.val().trim()) {
                    markFieldAsInvalid(fecha, 'Selecciona una fecha');
                    isValid = false;
                }
                
                const franjaHoraria = $('#franja-horaria-pl');
                if (!franjaHoraria.val().trim()) {
                    markFieldAsInvalid(franjaHoraria, 'Selecciona una franja horaria');
                    isValid = false;
                }
                break;
                
            case 3: // Medios de contacto
                const contactosSeleccionados = $('.contacto-checkbox-pl:checked');
                if (contactosSeleccionados.length === 0) {
                    $('#contacto-error-pl').show();
                    isValid = false;
                } else {
                    contactosSeleccionados.each(function() {
                        const detalleInput = $(this).closest('.contacto-option').find('.contacto-detalle-pl');
                        if (!detalleInput.val().trim()) {
                            markFieldAsInvalid(detalleInput, 'Este campo es obligatorio');
                            isValid = false;
                        } else if ($(this).attr('id') === 'contacto-email-pl') {
                            if (!isValidEmail(detalleInput.val())) {
                                markFieldAsInvalid(detalleInput, 'Ingresa un email válido');
                                isValid = false;
                            }
                        } else if ($(this).attr('id') === 'contacto-whatsapp-pl' || $(this).attr('id') === 'contacto-llamada-pl') {
                            if (!isValidPhone(detalleInput.val())) {
                                markFieldAsInvalid(detalleInput, 'Ingresa un número válido');
                                isValid = false;
                            }
                        }
                    });
                }
                break;
        }
        
        return isValid;
    }
    
    // Funciones auxiliares
    function markFieldAsInvalid(field, message) {
        field.addClass('input-error');
        field.next('.error-message').text(message).show();
    }
    
    function isValidEmail(email) {
        const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        return emailPattern.test(email);
    }
    
    function isValidPhone(phone) {
        const phonePattern = /^[0-9]{9,}$/;
        return phonePattern.test(phone);
    }
    
    // Manejar selección de tipo de empresa
    function handleEmpresaOption() {
        const tipo = $(this).data('option');
        $('#wizard-empresa-seleccion').hide();
        
        if (tipo === 'afiliado') {
            openWizard('wizard-empresas');
        } else if (tipo === 'afiliacion') {
            openWizard('wizard-afiliacion');
        }
    }
    
    // Manejar cambios de cantidad
    function handleQuantityChange() {
        const input = $(this).closest('.quantity-controls').find('.product-button-quantity');
        let value = parseInt(input.val()) || 0;
        
        if ($(this).hasClass('quantity-plus')) {
            input.val(value + 1);
        } else if ($(this).hasClass('quantity-minus') && value > 1) {
            input.val(value - 1);
        }
        
        input.trigger('change');
    }
    
    // Validar entrada de cantidad
    function validateQuantityInput() {
        let value = parseInt($(this).val());
        if (isNaN(value) || value < 1) {
            $(this).val(1);
        }
    }
    
    // Manejar selección de productos
    function handleProductSelection(e) {
        const checkbox = $(this).find('input[type="checkbox"]');
        const quantityControls = $(this).find('.quantity-controls');
        
        // Si el clic no fue en los controles de cantidad
        if (!quantityControls.is(e.target) && quantityControls.has(e.target).length === 0) {
            checkbox.prop('checked', !checkbox.prop('checked'));
            $(this).toggleClass('selected', checkbox.prop('checked'));
            
            // Manejar campos especiales si existen
            const specialType = checkbox.data('special');
            if (specialType) {
                $(`#${specialType}-container`).toggle(checkbox.prop('checked'));
                if (!checkbox.prop('checked')) {
                    $(`#${specialType}-desc`).val('');
                }
            }
        }
    }
    
    // Manejar selección de contacto
    function handleContactSelection() {
        const checkbox = $(this).find('input[type="checkbox"]');
        checkbox.prop('checked', !checkbox.prop('checked'));
        $(this).toggleClass('selected', checkbox.prop('checked'));
        
        // Mostrar/ocultar campo de detalle
        const detalleContainer = $(this).closest('.contacto-option').find('.contacto-detalle-container');
        detalleContainer.toggle(checkbox.prop('checked'));
        
        if (!checkbox.prop('checked')) {
            detalleContainer.find('input').val('');
        }
    }
    
    // Manejar selección de opciones
    function handleOptionSelection() {
        const radio = $(this).find('input[type="radio"]');
        const groupName = radio.attr('name');
        
        // Deseleccionar otros botones en el mismo grupo
        $(`input[name="${groupName}"]`).prop('checked', false).parent().removeClass('selected');
        
        // Seleccionar el actual
        radio.prop('checked', true);
        $(this).addClass('selected');
        
        // Mostrar/ocultar campos especiales según la selección
        if (radio.attr('id') === 'producto-no-acordado') {
            $('#producto-no-acordado-container').show();
        } else if (radio.attr('id') === 'volumen-otro') {
            $('#volumen-otro-container').show();
        } else {
            // Ocultar campos especiales si no son relevantes
            $('#producto-no-acordado-container, #volumen-otro-container').hide();
        }
    }
    
    // Actualizar valor del peso
    function updateWeightValue() {
        $('#weight-value').text($(this).val() + ' kg');
    }
    
    // Reiniciar peso
    function resetWeight() {
        $('#weight-slider').val(0);
        $('#weight-value').text('0 kg');
    }
    
    // Validar entrada de teléfono
    function validatePhoneInput() {
        this.value = this.value.replace(/[^0-9]/g, '');
    }
    
    // Cerrar wizard
    function handleCloseWizard() {
        const wizardId = $(this).data('wizard') || currentWizard;
        $(`#${wizardId}`).hide();
        currentWizard = null;
    }
    
    // Confirmar cierre de wizard
    function confirmCloseWizard() {
        $('#close-confirm-modal').hide();
        if (currentWizard) {
            $(`#${currentWizard}`).hide();
            currentWizard = null;
        }
    }
    
    // Funciones para generar resúmenes
    function generateResumenPedidoDomicilio() {
        const resumen = $('#resumen-pedido-domicilio');
        let html = '<div class="summary-section"><div class="summary-title">Resumen del pedido</div>';
        html += '<div class="summary-content">';
        
        // Agregar datos básicos
        if (formData.nombre) {
            html += `<div class="summary-item"><strong>Nombre:</strong> ${formData.nombre}</div>`;
        }
        
        // Agregar productos
        if (formData.productos && formData.productos.length > 0) {
            html += `<div class="summary-item"><strong>Productos:</strong> `;
            formData.productos.forEach((producto, index) => {
                html += `${producto.nombre} (${producto.cantidad})`;
                if (producto.descripcion) {
                    html += ` - ${producto.descripcion}`;
                }
                if (index < formData.productos.length - 1) {
                    html += ', ';
                }
            });
            html += `</div>`;
        }
        
        // Agregar direcciones
        if (formData.direccion_recogida) {
            html += `<div class="summary-item"><strong>Dirección de recogida:</strong> ${formData.direccion_recogida}`;
            if (formData.piso_recogida) {
                html += `, ${formData.piso_recogida}`;
            }
            if (formData.cp_recogida) {
                html += `, CP: ${formData.cp_recogida}`;
            }
            html += `</div>`;
        }
        
        if (formData.direccion_entrega) {
            html += `<div class="summary-item"><strong>Dirección de entrega:</strong> ${formData.direccion_entrega}`;
            if (formData.piso_entrega) {
                html += `, ${formData.piso_entrega}`;
            }
            if (formData.cp_entrega) {
                html += `, CP: ${formData.cp_entrega}`;
            }
            html += `</div>`;
        }
        
        // Agregar fecha y hora
        if (formData.fecha) {
            html += `<div class="summary-item"><strong>Fecha:</strong> ${formData.fecha}</div>`;
        }
        
        if (formData.franja_horaria) {
            html += `<div class="summary-item"><strong>Franja horaria:</strong> ${formData.franja_horaria}</div>`;
        }
        
        // Agregar medios de contacto
        if (formData.mediosContacto && formData.mediosContacto.length > 0) {
            html += `<div class="summary-item"><strong>Medios de contacto:</strong> `;
            formData.mediosContacto.forEach((contacto, index) => {
                html += `${contacto.tipo}: ${contacto.valor}`;
                if (index < formData.mediosContacto.length - 1) {
                    html += ', ';
                }
            });
            html += `</div>`;
        }
        
        html += '</div></div>';
        resumen.html(html);
    }
    
    function generateResumenPuntoLimpio() {
        const resumen = $('#resumen-pedido-punto-limpio');
        let html = '<div class="summary-section"><div class="summary-title">Resumen del pedido a punto limpio</div>';
        html += '<div class="summary-content">';
        
        // Agregar estado del producto
        if (formData.estado_producto_pl) {
            html += `<div class="summary-item"><strong>Estado del producto:</strong> ${formData.estado_producto_pl}</div>`;
        }
        
        // Agregar dirección de recogida
        if (formData.direccion_recogida_pl) {
            html += `<div class="summary-item"><strong>Dirección de recogida:</strong> ${formData.direccion_recogida_pl}`;
            if (formData.piso_recogida_pl) {
                html += `, ${formData.piso_recogida_pl}`;
            }
            if (formData.cp_recogida_pl) {
                html += `, CP: ${formData.cp_recogida_pl}`;
            }
            html += `</div>`;
        }
        
        // Agregar fecha y hora
        if (formData.fecha_pl) {
            html += `<div class="summary-item"><strong>Fecha:</strong> ${formData.fecha_pl}</div>`;
        }
        
        if (formData.franja_horaria_pl) {
            html += `<div class="summary-item"><strong>Franja horaria:</strong> ${formData.franja_horaria_pl}</div>`;
        }
        
        // Agregar medios de contacto
        if (formData.mediosContacto && formData.mediosContacto.length > 0) {
            html += `<div class="summary-item"><strong>Medios de contacto:</strong> `;
            formData.mediosContacto.forEach((contacto, index) => {
                html += `${contacto.tipo}: ${contacto.valor}`;
                if (index < formData.mediosContacto.length - 1) {
                    html += ', ';
                }
            });
            html += `</div>`;
        }
        
        html += '</div></div>';
        resumen.html(html);
    }
    
    function generateResumenAfiliado() {
        const resumen = $('#resumen-afiliado');
        let html = '<div class="summary-section"><div class="summary-title">Resumen del pedido de afiliado</div>';
        html += '<div class="summary-content">';
        
        // Agregar datos básicos
        if (formData.codigo_cliente) {
            html += `<div class="summary-item"><strong>Código de cliente:</strong> ${formData.codigo_cliente}</div>`;
        }
        
        if (formData.nombre_afiliado) {
            html += `<div class="summary-item"><strong>Nombre:</strong> ${formData.nombre_afiliado}</div>`;
        }
        
        if (formData.telefono_afiliado) {
            html += `<div class="summary-item"><strong>Teléfono:</strong> ${formData.telefono_afiliado}</div>`;
        }
        
        // Agregar direcciones
        if (formData.afiliado_recogida) {
            html += `<div class="summary-item"><strong>Dirección de recogida:</strong> ${formData.afiliado_recogida}`;
            if (formData.piso_recogida_afiliado) {
                html += `, ${formData.piso_recogida_afiliado}`;
            }
            if (formData.cp_recogida_afiliado) {
                html += `, CP: ${formData.cp_recogida_afiliado}`;
            }
            html += `</div>`;
        }
        
        if (formData.afiliado_entrega) {
            html += `<div class="summary-item"><strong>Dirección de entrega:</strong> ${formData.afiliado_entrega}`;
            if (formData.piso_entrega_afiliado) {
                html += `, ${formData.piso_entrega_afiliado}`;
            }
            if (formData.cp_entrega_afiliado) {
                html += `, CP: ${formData.cp_entrega_afiliado}`;
            }
            html += `</div>`;
        }
        
        // Agregar fecha y hora
        if (formData.afiliado_fecha) {
            html += `<div class="summary-item"><strong>Fecha:</strong> ${formData.afiliado_fecha}</div>`;
        }
        
        if (formData.afiliado_hora) {
            html += `<div class="summary-item"><strong>Hora:</strong> ${formData.afiliado_hora}</div>`;
        }
        
        // Agregar tipo de producto
        const tipoProducto = $('input[name="tipo-producto"]:checked');
        if (tipoProducto.length) {
            let tipoText = tipoProducto.parent().text().trim();
            if (tipoProducto.val() === 'no-acordado' && formData.producto_no_acordado_desc) {
                tipoText += `: ${formData.producto_no_acordado_desc}`;
            }
            html += `<div class="summary-item"><strong>Tipo de producto:</strong> ${tipoText}</div>`;
        }
        
        html += '</div></div>';
        resumen.html(html);
    }
    
    function generateResumenAfiliacion() {
        const resumen = $('#resumen-afiliacion');
        let html = '<div class="summary-section"><div class="summary-title">Resumen de solicitud de afiliación</div>';
        html += '<div class="summary-content">';
        
        // Agregar datos básicos
        if (formData.nombre_empresa) {
            html += `<div class="summary-item"><strong>Nombre de la empresa:</strong> ${formData.nombre_empresa}</div>`;
        }
        
        if (formData.cif) {
            html += `<div class="summary-item"><strong>CIF:</strong> ${formData.cif}</div>`;
        }
        
        if (formData.responsable) {
            html += `<div class="summary-item"><strong>Responsable:</strong> ${formData.responsable}</div>`;
        }
        
        if (formData.telefono_empresa) {
            html += `<div class="summary-item"><strong>Teléfono:</strong> ${formData.telefono_empresa}</div>`;
        }
        
        if (formData.email_empresa) {
            html += `<div class="summary-item"><strong>Email:</strong> ${formData.email_empresa}</div>`;
        }
        
        // Agregar volumen de envíos
        const volumen = $('input[name="volumen-envios"]:checked');
        if (volumen.length) {
            let volumenText = volumen.parent().text().trim();
            if (volumen.val() === 'otro' && formData.volumen_otro_desc) {
                volumenText += `: ${formData.volumen_otro_desc} envíos/mes`;
            } else {
                volumenText += ' envíos/mes';
            }
            html += `<div class="summary-item"><strong>Volumen de envíos:</strong> ${volumenText}</div>`;
        }
        
        html += '</div></div>';
        resumen.html(html);
    }
    
    // Inicializar la aplicación
    init();
});
</script>

</body>
</html>